<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Extend btrfs root partition | Dhananjay's Blog</title><link rel=canonical href=https://dhananjaylatkar.github.io/posts/extend_btrfs_size/><meta name=description content="Hello there ðŸ‘‹. 

This blog is a collection of articles that will help others (including future me ðŸ™ƒ). All the posts are a compilation of things I read on the internet, man pages and Docs."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Extend btrfs root partition"><meta property="og:description" content="Introduction This article will demonstrate how to increase btrfs root partition size.
Use case:
 In dual boot system (Fedora + Windows), use unsed disk space in Windows for Fedora.  Steps Shrink Windows drive  Boot into Windows. Shrink unsed drive using Disk Manager.  Create partition  Boot into Fedora. Use gpart (CLI) or Disks (GUI) to create partition. Check partition using lsblk. (nvme0n1p8 is newly created partition). âžœ sudo lsblk [sudo] password for dhananjay: NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS zram0 252:0 0 8G 0 disk [SWAP] nvme0n1 259:0 0 476."><meta property="og:type" content="article"><meta property="og:url" content="https://dhananjaylatkar.github.io/posts/extend_btrfs_size/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-06T00:25:44+05:30"><meta property="article:modified_time" content="2023-03-06T00:25:44+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Extend btrfs root partition"><meta name=twitter:description content="Introduction This article will demonstrate how to increase btrfs root partition size.
Use case:
 In dual boot system (Fedora + Windows), use unsed disk space in Windows for Fedora.  Steps Shrink Windows drive  Boot into Windows. Shrink unsed drive using Disk Manager.  Create partition  Boot into Fedora. Use gpart (CLI) or Disks (GUI) to create partition. Check partition using lsblk. (nvme0n1p8 is newly created partition). âžœ sudo lsblk [sudo] password for dhananjay: NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS zram0 252:0 0 8G 0 disk [SWAP] nvme0n1 259:0 0 476."><link rel=stylesheet href=https://dhananjaylatkar.github.io/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://dhananjaylatkar.github.io/images/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-200656436-1","auto"),ga("send","pageview"))</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/categories>Categories</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://dhananjaylatkar.github.io/posts/vim-cheatsheet/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://dhananjaylatkar.github.io/posts/rebase_with_upstream_fork/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&text=Extend%20btrfs%20root%20partition" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&title=Extend%20btrfs%20root%20partition" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&is_video=false&description=Extend%20btrfs%20root%20partition" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Extend%20btrfs%20root%20partition&body=Check out this article: https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&title=Extend%20btrfs%20root%20partition" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&title=Extend%20btrfs%20root%20partition" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&name=Extend%20btrfs%20root%20partition&description=Introduction%20This%20article%20will%20demonstrate%20how%20to%20increase%20btrfs%20root%20partition%20size.%0aUse%20case%3a%0a%20In%20dual%20boot%20system%20%28Fedora%20%2b%20Windows%29%2c%20use%20unsed%20disk%20space%20in%20Windows%20for%20Fedora.%20%20Steps%20Shrink%20Windows%20drive%20%20Boot%20into%20Windows.%20Shrink%20unsed%20drive%20using%20Disk%20Manager.%20%20Create%20partition%20%20Boot%20into%20Fedora.%20Use%20gpart%20%28CLI%29%20or%20Disks%20%28GUI%29%20to%20create%20partition.%20Check%20partition%20using%20lsblk.%20%28nvme0n1p8%20is%20newly%20created%20partition%29.%20%e2%9e%9c%20sudo%20lsblk%20%5bsudo%5d%20password%20for%20dhananjay%3a%20NAME%20MAJ%3aMIN%20RM%20SIZE%20RO%20TYPE%20MOUNTPOINTS%20zram0%20252%3a0%200%208G%200%20disk%20%5bSWAP%5d%20nvme0n1%20259%3a0%200%20476." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&t=Extend%20btrfs%20root%20partition" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#steps>Steps</a><ul><li><a href=#shrink-windows-drive>Shrink Windows drive</a></li><li><a href=#create-partition>Create partition</a></li><li><a href=#extend-root>Extend root</a></li><li><a href=#balancing-data-between-2-partitions-optional>Balancing data between 2 partitions (Optional)</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Extend btrfs root partition</h1><div class=meta><div class=postdate><time datetime="2023-03-06 00:25:44 +0530 +0530" itemprop=datePublished>2023-03-06</time></div><div class=article-read-time><i class="far fa-clock"></i>
1 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/operating-system>operating system</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/btrfs rel=tag>btrfs</a>
,
<a class=tag-link href=/tags/linux rel=tag>linux</a>
,
<a class=tag-link href=/tags/filesystem rel=tag>filesystem</a>
,
<a class=tag-link href=/tags/fs rel=tag>fs</a>
,
<a class=tag-link href=/tags/fedora rel=tag>fedora</a></div></div></header><div class=content itemprop=articleBody><h2 id=introduction>Introduction</h2><p>This article will demonstrate how to increase btrfs root partition size.</p><p>Use case:</p><ul><li>In dual boot system (Fedora + Windows), use unsed disk space in Windows for Fedora.</li></ul><h2 id=steps>Steps</h2><h3 id=shrink-windows-drive>Shrink Windows drive</h3><ul><li>Boot into Windows.</li><li>Shrink unsed drive using Disk Manager.</li></ul><h3 id=create-partition>Create partition</h3><ul><li>Boot into Fedora.</li><li>Use <code>gpart</code> (CLI) or Disks (GUI) to create partition.</li><li>Check partition using <code>lsblk</code>. (<code>nvme0n1p8</code> is newly created partition).<pre tabindex=0><code>âžœ sudo lsblk
[sudo] password for dhananjay:
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
zram0       252:0    0     8G  0 disk [SWAP]
nvme0n1     259:0    0 476.9G  0 disk
...
â”œâ”€nvme0n1p6 259:6    0     1G  0 part /boot
â”œâ”€nvme0n1p7 259:7    0 145.5G  0 part /home
â”‚                                     /
â””â”€nvme0n1p8 259:8    0 169.1G  0 part
</code></pre></li></ul><h3 id=extend-root>Extend root</h3><ul><li><code>df</code> output before extending.<pre tabindex=0><code>âžœ df
Filesystem      Size  Used Avail Use% Mounted on
...
/dev/nvme0n1p7  146G  113G   32G  79% /
...
</code></pre></li><li>Extend <code>/</code> using <code>btrfs</code> tool.<pre tabindex=0><code>âžœ sudo btrfs device add -f /dev/nvme0n1p8 /
Performing full device TRIM /dev/nvme0n1p8 (169.14GiB) ...
</code></pre></li><li><code>df</code> output after extending.<pre tabindex=0><code>âžœ df
Filesystem      Size  Used Avail Use% Mounted on
...
/dev/nvme0n1p7  315G  113G  201G  37% /
...
</code></pre></li><li>That&rsquo;s all!</li></ul><h3 id=balancing-data-between-2-partitions-optional>Balancing data between 2 partitions (Optional)</h3><ul><li>Check device usage.<pre tabindex=0><code>âžœ sudo btrfs device usage /
/dev/nvme0n1p7, ID: 1
   Device size:           145.48GiB
   Device slack:              0.00B
   Data,single:           138.01GiB
   Metadata,DUP:            4.00GiB
   System,DUP:             16.00MiB
   Unallocated:             3.46GiB

/dev/nvme0n1p8, ID: 2
   Device size:           169.14GiB
   Device slack:              0.00B
   Unallocated:           169.14GiB
</code></pre></li><li>Run following command to balance the data. (It takes time based on disk size.)<pre tabindex=0><code>âžœ sudo btrfs device usage /
</code></pre></li><li>Verify device usage.<pre tabindex=0><code>âžœ sudo btrfs device usage /
[sudo] password for dhananjay:
/dev/nvme0n1p7, ID: 1
   Device size:           145.48GiB
   Device slack:              0.00B
   Data,single:            72.00GiB
   Metadata,DUP:            2.00GiB
   System,DUP:             64.00MiB
   Unallocated:            71.42GiB

/dev/nvme0n1p8, ID: 2
   Device size:           169.14GiB
   Device slack:              0.00B
   Data,single:            96.00GiB
   Metadata,DUP:            2.00GiB
   Unallocated:            71.14GiB
</code></pre></li></ul></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/categories>Categories</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#steps>Steps</a><ul><li><a href=#shrink-windows-drive>Shrink Windows drive</a></li><li><a href=#create-partition>Create partition</a></li><li><a href=#extend-root>Extend root</a></li><li><a href=#balancing-data-between-2-partitions-optional>Balancing data between 2 partitions (Optional)</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&text=Extend%20btrfs%20root%20partition" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&title=Extend%20btrfs%20root%20partition" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&is_video=false&description=Extend%20btrfs%20root%20partition" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Extend%20btrfs%20root%20partition&body=Check out this article: https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&title=Extend%20btrfs%20root%20partition" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&title=Extend%20btrfs%20root%20partition" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&name=Extend%20btrfs%20root%20partition&description=Introduction%20This%20article%20will%20demonstrate%20how%20to%20increase%20btrfs%20root%20partition%20size.%0aUse%20case%3a%0a%20In%20dual%20boot%20system%20%28Fedora%20%2b%20Windows%29%2c%20use%20unsed%20disk%20space%20in%20Windows%20for%20Fedora.%20%20Steps%20Shrink%20Windows%20drive%20%20Boot%20into%20Windows.%20Shrink%20unsed%20drive%20using%20Disk%20Manager.%20%20Create%20partition%20%20Boot%20into%20Fedora.%20Use%20gpart%20%28CLI%29%20or%20Disks%20%28GUI%29%20to%20create%20partition.%20Check%20partition%20using%20lsblk.%20%28nvme0n1p8%20is%20newly%20created%20partition%29.%20%e2%9e%9c%20sudo%20lsblk%20%5bsudo%5d%20password%20for%20dhananjay%3a%20NAME%20MAJ%3aMIN%20RM%20SIZE%20RO%20TYPE%20MOUNTPOINTS%20zram0%20252%3a0%200%208G%200%20disk%20%5bSWAP%5d%20nvme0n1%20259%3a0%200%20476." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fdhananjaylatkar.github.io%2fposts%2fextend_btrfs_size%2f&t=Extend%20btrfs%20root%20partition" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Dhananjay</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/categories>Categories</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script></html>